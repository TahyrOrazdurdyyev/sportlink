# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö features

## ‚úÖ –í—Å–µ features —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã!

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π** ‚úÖ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
   - API endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

2. **–ü–æ–¥–±–æ—Ä —Å–æ–ø–µ—Ä–Ω–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—é** ‚úÖ
   - –ê–ª–≥–æ—Ä–∏—Ç–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ (0-100 –±–∞–ª–ª–æ–≤)
   - –§–∏–ª—å—Ç—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—é, –≥–æ—Ä–æ–¥—É, –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   - –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π —Å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏
   - –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É —Å feature `opponent_matching`

3. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚úÖ
   - –ò—Å—Ç–æ—Ä–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
   - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –¥–Ω—è–º/—á–∞—Å–∞–º
   - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
   - –õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã
   - –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É —Å feature `advanced_statistics`

4. **–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫** ‚úÖ
   - –ú–æ–¥–µ–ª—å `UserSubscription`
   - –î–µ–∫–æ—Ä–∞—Ç–æ—Ä `@require_feature` –¥–ª—è –∑–∞—â–∏—Ç—ã endpoints
   - API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. Backend –∑–∞–ø—É—â–µ–Ω
```bash
cd /Users/tahyr/Documents/sportlink/backend
python3.11 manage.py runserver
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

```bash
cd /Users/tahyr/Documents/sportlink/backend
python3.11 -c "
import os
import django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'sportlink.settings')
django.setup()

from apps.users.models import User
from apps.subscriptions.models import SubscriptionPlan
from apps.subscriptions.models_user import UserSubscription
from datetime import datetime, timedelta

# –ü–æ–ª—É—á–∏—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞)
user = User.objects.first()
print(f'User: {user.phone_number}')

# –ü–æ–ª—É—á–∏—Ç–µ –ø–ª–∞–Ω
plan = SubscriptionPlan.objects.first()
print(f'Plan: {plan.name}')

# –°–æ–∑–¥–∞–π—Ç–µ –ø–æ–¥–ø–∏—Å–∫—É
subscription = UserSubscription(
    user=user,
    plan=plan,
    start_date=datetime.utcnow(),
    end_date=datetime.utcnow() + timedelta(days=30),
    status='active',
    amount_paid=plan.monthly_price,
    payment_method='test'
)
subscription.save()
print(f'‚úÖ Subscription created: {subscription.id}')
"
```

### 3. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

```bash
# –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –∏–ª–∏ mobile –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–æ–∫–µ–Ω –∏–∑ localStorage –∏–ª–∏ –∏–∑ –æ—Ç–≤–µ—Ç–∞ API
```

### 4. –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ endpoints

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–ª–æ—â–∞–¥–∫–∏:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/bookings/check-availability/?court_id=COURT_ID&start_time=2024-12-22T14:00:00Z&end_time=2024-12-22T16:00:00Z"
```

#### –ü–æ–∏—Å–∫ —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/users/find-opponents/?limit=10"
```

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/users/statistics/?range=30"
```

#### –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/users/achievements/"
```

#### –ú–æ—è –ø–æ–¥–ø–∏—Å–∫–∞:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/admin/subscriptions/my-subscription/"
```

#### –ú–æ–∏ features:
```bash
curl -H "Authorization: Bearer YOUR_TOKEN" \
  "http://localhost:8000/api/v1/admin/subscriptions/my-features/"
```

### 5. –¢–µ—Å—Ç –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏

–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ:

```bash
curl -H "Authorization: Bearer NEW_USER_TOKEN" \
  "http://localhost:8000/api/v1/users/find-opponents/"
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è HTTP 403:
```json
{
  "error": "Subscription required",
  "feature": "opponent_matching",
  "message": "This feature requires an active subscription"
}
```

---

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Backend:
```
backend/apps/bookings/views.py                    - —É–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
backend/apps/users/views_matching.py              - –ø–æ–¥–±–æ—Ä —Å–æ–ø–µ—Ä–Ω–∏–∫–æ–≤
backend/apps/users/views_statistics.py            - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
backend/apps/subscriptions/models_user.py         - –º–æ–¥–µ–ª—å UserSubscription
backend/apps/subscriptions/permissions.py         - –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä @require_feature
backend/apps/subscriptions/views_user.py          - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
```

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:
```
FEATURES_IMPLEMENTATION.md  - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è backend
FLUTTER_INTEGRATION.md      - –ø—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ Flutter
TESTING.md                  - —ç—Ç–æ—Ç —Ñ–∞–π–ª
```

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ endpoints** —á–µ—Ä–µ–∑ Postman –∏–ª–∏ curl
2. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –≤ Flutter** –∏—Å–ø–æ–ª—å–∑—É—è –ø—Ä–∏–º–µ—Ä—ã –∏–∑ `FLUTTER_INTEGRATION.md`
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É** –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
4. **–î–æ–±–∞–≤—å—Ç–µ webhook –¥–ª—è –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏—è** –ø–æ–¥–ø–∏—Å–æ–∫

---

## üìû –í—Å–µ –≥–æ—Ç–æ–≤–æ!

Backend –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ. –í—Å–µ features —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –∑–∞—â–∏—â–µ–Ω—ã —Å–∏—Å—Ç–µ–º–æ–π –ø–æ–¥–ø–∏—Å–æ–∫.

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ backend –∏ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å!** üöÄ

